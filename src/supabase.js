// ============================================================// SitePro — Supabase Configuration// ============================================================// INSTRUCTIONS: Replace the two values below with your own// from Supabase → Project Settings → API// ============================================================const SUPABASE_URL = https://wxytzvfhiwwxmjraiaav.supabase.coconst SUPABASE_KEY = sb_publishable_3Sc8bbrE24itJ4HZBkihFA_UwbeBSEL// ============================================================// Lightweight Supabase client (no npm package needed!)// This talks directly to the Supabase REST API.// ============================================================let accessToken = null;let refreshToken = null;let currentUser = null;const headers = () => ({  'Content-Type': 'application/json',  'apikey': SUPABASE_KEY,  'Authorization': `Bearer ${accessToken || SUPABASE_KEY}`,});// ---------- AUTH ----------export async function signUp(email, password, fullName) {  const res = await fetch(`${SUPABASE_URL}/auth/v1/signup`, {    method: 'POST', headers: { 'Content-Type': 'application/json', 'apikey': SUPABASE_KEY },    body: JSON.stringify({ email, password, data: { full_name: fullName } }),  });  const data = await res.json();  if (data.error) throw new Error(data.error.message || data.msg || 'Signup failed');  if (data.access_token) {    accessToken = data.access_token;    refreshToken = data.refresh_token;    currentUser = data.user;    localStorage.setItem('sb_access', accessToken);    localStorage.setItem('sb_refresh', refreshToken);    localStorage.setItem('sb_user', JSON.stringify(currentUser));  }  return data;}export async function signIn(email, password) {  const res = await fetch(`${SUPABASE_URL}/auth/v1/token?grant_type=password`, {    method: 'POST', headers: { 'Content-Type': 'application/json', 'apikey': SUPABASE_KEY },    body: JSON.stringify({ email, password }),  });  const data = await res.json();  if (data.error) throw new Error(data.error.message || data.msg || 'Login failed');  accessToken = data.access_token;  refreshToken = data.refresh_token;  currentUser = data.user;  localStorage.setItem('sb_access', accessToken);  localStorage.setItem('sb_refresh', refreshToken);  localStorage.setItem('sb_user', JSON.stringify(currentUser));  return data;}export async function signOut() {  try {    await fetch(`${SUPABASE_URL}/auth/v1/logout`, {      method: 'POST', headers: headers(),    });  } catch (e) {}  accessToken = null; refreshToken = null; currentUser = null;  localStorage.removeItem('sb_access');  localStorage.removeItem('sb_refresh');  localStorage.removeItem('sb_user');}export async function refreshSession() {  const rt = refreshToken || localStorage.getItem('sb_refresh');  if (!rt) return null;  try {    const res = await fetch(`${SUPABASE_URL}/auth/v1/token?grant_type=refresh_token`, {      method: 'POST', headers: { 'Content-Type': 'application/json', 'apikey': SUPABASE_KEY },      body: JSON.stringify({ refresh_token: rt }),    });    const data = await res.json();    if (data.access_token) {      accessToken = data.access_token;      refreshToken = data.refresh_token;      currentUser = data.user;      localStorage.setItem('sb_access', accessToken);      localStorage.setItem('sb_refresh', refreshToken);      localStorage.setItem('sb_user', JSON.stringify(currentUser));      return data.user;    }  } catch (e) {}  return null;}export function getUser() {  if (currentUser) return currentUser;  try {    const u = localStorage.getItem('sb_user');    if (u) { currentUser = JSON.parse(u); return currentUser; }  } catch (e) {}  return null;}export function isLoggedIn() {  return !!(accessToken || localStorage.getItem('sb_access'));}export async function restoreSession() {  const t = localStorage.getItem('sb_access');  const rt = localStorage.getItem('sb_refresh');  if (t) {    accessToken = t;    refreshToken = rt;    try { const u = localStorage.getItem('sb_user'); if (u) currentUser = JSON.parse(u); } catch (e) {}    // Try refresh to ensure token is still valid    const user = await refreshSession();    return !!user;  }  return false;}// ---------- DATABASE (REST API) ----------const API = `${SUPABASE_URL}/rest/v1`;export async function query(table, { select = '*', filter = '', order = '', limit = '' } = {}) {  let url = `${API}/${table}?select=${select}`;  if (filter) url += `&${filter}`;  if (order) url += `&order=${order}`;  if (limit) url += `&limit=${limit}`;  const res = await fetch(url, { headers: headers() });  if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.message || 'Query failed'); }  return res.json();}export async function insert(table, data) {  const res = await fetch(`${API}/${table}`, {    method: 'POST', headers: { ...headers(), 'Prefer': 'return=representation' },    body: JSON.stringify(data),  });  if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.message || 'Insert failed'); }  return res.json();}export async function update(table, id, data) {  const res = await fetch(`${API}/${table}?id=eq.${id}`, {    method: 'PATCH', headers: { ...headers(), 'Prefer': 'return=representation' },    body: JSON.stringify(data),  });  if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.message || 'Update failed'); }  return res.json();}export async function remove(table, id) {  const res = await fetch(`${API}/${table}?id=eq.${id}`, {    method: 'DELETE', headers: headers(),  });  if (!res.ok) { const e = await res.json().catch(() => ({})); throw new Error(e.message || 'Delete failed'); }  return true;}